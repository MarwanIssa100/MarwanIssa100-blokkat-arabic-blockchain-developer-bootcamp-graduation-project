(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2377:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var a=n(5155),s=n(5966),i=n(7552),r=n(5367);let l={address:"0xCF85AE46F9254D28338E54a10810877Db54b2bAF",abi:[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"string",name:"title",type:"string"},{indexed:!1,internalType:"string",name:"description",type:"string"}],name:"IdeaCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"address",name:"funder",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"IdeaFunded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"address",name:"backer",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"refunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"withdrawFunds",type:"event"},{inputs:[],name:"FeePercentage",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"completeIdea",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"address",name:"",type:"address"}],name:"contributions",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"title",type:"string"},{internalType:"string",name:"description",type:"string"},{internalType:"uint256",name:"goal",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"}],name:"createIdea",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"fundIdea",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"ideaId",type:"uint256"}],name:"getIdea",outputs:[{internalType:"string",name:"",type:"string"},{internalType:"string",name:"",type:"string"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"backer",type:"address"}],name:"refund",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"toggleActive",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"totalIdeas",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"withdrawFees",outputs:[],stateMutability:"nonpayable",type:"function"}],chainId:n(7608).dk1.id};var d=n(2143),o=n(4494),u=n(2115),c=n(5695),p=n(7638),m=n(5139);function y(){(0,c.useRouter)();let{address:e,isConnected:t}=(0,s.F)(),[n,y]=(0,u.useState)(""),[x,g]=(0,u.useState)(""),[b,h]=(0,u.useState)(""),[f,w]=(0,u.useState)(""),[N,v]=(0,u.useState)(null),{data:j}=(0,i.Q)({...l,functionName:"totalIdeas"}),{writeContract:T,isPending:C,isSuccess:I}=(0,r.x)(),k=e=>{e&&T({address:l.address,abi:l.abi,functionName:"completeIdea",args:[BigInt(e)]})};(0,u.useEffect)(()=>{I&&alert("Idea marked as completed successfully!")},[I]);let S=function(){let e=(0,p.e)({chainId:m.d.id});if(!e)throw Error("publicClient not available");return e}(),[F,M]=(0,u.useState)([]),[E,O]=(0,u.useState)(!0),[B,P]=(0,u.useState)(null);(0,u.useEffect)(()=>{(async()=>{if(void 0!==j){O(!0),P(null);try{let e=[],t=Number(j);for(let n=1;n<=t;n++)e.push(S.readContract({address:l.address,abi:l.abi,functionName:"getIdea",args:[BigInt(n)]}));let n=(await Promise.all(e)).map((e,t)=>e?{id:t+1,title:e[0],description:e[1],owner:e[2],fundGoal:e[3],deadline:e[4],amountCollected:e[5],completed:e[6]}:null).filter(Boolean);M(n)}catch(e){console.error("Error fetching ideas:",e),P("Failed to load ideas")}finally{O(!1)}}})()},[j]);let{writeContract:A,isPending:G,isSuccess:D,data:L}=(0,r.x)(),_=async()=>{if(!n||!x||!b)return void alert("Please fill all required fields");try{let t=Math.floor(Date.now()/1e3)+2592e3,a=(0,d.g)(b.toString()),s={id:F.length+1,title:n,description:x,owner:e||"",fundGoal:a,deadline:BigInt(t),amountCollected:BigInt(0),completed:!1};M(e=>[...e,s]),y(""),g(""),h(""),await A({address:l.address,abi:l.abi,functionName:"createIdea",args:[n,x,a,BigInt(t)]})}catch(e){console.error("Error creating idea:",e),M(e=>e.slice(0,-1)),alert("Failed to create idea. See console for details.")}};(0,u.useEffect)(()=>{D&&j&&(async()=>{let e=await S.readContract({address:l.address,abi:l.abi,functionName:"getIdea",args:[j]});M(t=>t.map(t=>t.id===Number(j)?{...t,...e}:t))})()},[D,j]);let{writeContract:q,isPending:H}=(0,r.x)(),{writeContract:R,isPending:z}=(0,r.x)(),[U,V]=(0,u.useState)(BigInt(0)),[W,Q]=(0,u.useState)(!1),[J,K]=(0,u.useState)(null),[X,Y]=(0,u.useState)(null),Z=async t=>{if(!e)return void alert("Please connect your wallet");Q(!0),K(null);try{await A({address:l.address,abi:l.abi,functionName:"refund",args:[BigInt(t),e]})}catch(e){K(e)}finally{Q(!1)}},$=e=>{R({...l,functionName:"withdraw",args:[BigInt(e)]})};return(0,a.jsxs)("main",{className:"container mx-auto p-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"SparkUp"}),t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("section",{className:"mb-12 p-6 rounded-lg shadow-md",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"Create New Idea"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium mb-1",children:"Title*"}),(0,a.jsx)("input",{id:"title",type:"text",placeholder:"My Awesome Project",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:n,onChange:e=>y(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium mb-1",children:"Description*"}),(0,a.jsx)("textarea",{id:"description",placeholder:"Describe your idea in detail...",rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:x,onChange:e=>g(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"fundingGoal",className:"block text-sm font-medium mb-1",children:"Funding Goal (ETH)*"}),(0,a.jsx)("input",{id:"fundingGoal",type:"number",min:"0.01",step:"0.01",placeholder:"1.00",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:b,onChange:e=>{parseFloat(e.target.value)>=0&&h(e.target.value)},required:!0})]}),(0,a.jsx)("button",{onClick:_,disabled:G||!n||!x||!b,className:"w-full py-3 px-4 rounded-lg font-medium text-white transition-colors ".concat(G?"bg-gray-400 cursor-not-allowed":n&&x&&b?"bg-blue-600 hover:bg-blue-700":"bg-blue-400 cursor-not-allowed"),children:G?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Idea"}),L&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-green-50 text-green-700 rounded-lg text-sm",children:["Transaction submitted!"," ",(0,a.jsx)("a",{href:"https://sepolia.scrollscan.com//tx/".concat(L),target:"_blank",rel:"noopener noreferrer",className:"text-green-600 underline hover:text-green-800",children:"View on Scroll Scan"})]})]})]}),(0,a.jsxs)("section",{className:"mb-12 p-6 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Fund an Idea"}),(0,a.jsxs)("div",{className:"flex space-x-4 ",children:[(0,a.jsxs)("select",{className:"p-2 border rounded flex-1",value:null!=N?N:"",onChange:e=>v(Number(e.target.value)),children:[(0,a.jsx)("option",{className:"bg-black",value:"",children:"Select an idea"}),F.map(e=>(0,a.jsxs)("option",{className:"bg-black",value:e.id,children:[e.title," (Goal: ",(0,o.c)(e.fundGoal)," ETH)"]},e.id))]}),(0,a.jsx)("input",{type:"number",placeholder:"Amount (ETH)",className:"p-2 border rounded w-32",value:f,onChange:e=>w(e.target.value)}),(0,a.jsx)("button",{onClick:()=>{N&&f&&q({...l,functionName:"fundIdea",args:[BigInt(N)],value:(0,d.g)(f)})},disabled:!N||H,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 disabled:bg-gray-400",children:H?"Funding...":"Fund"})]})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"All Ideas"}),E?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading ideas..."}):B?(0,a.jsx)("div",{className:"text-center py-8 text-red-500",children:B}):F&&F.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:F.map(t=>{let n=Number(t.fundGoal),s=Number(t.amountCollected),i=Number(t.deadline),r=n>0?Math.min(100,s/n*100):0;return(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:t.title||"Untitled Idea"}),(0,a.jsx)("p",{className:"text-gray-600",children:t.description||"No description provided"}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-2",children:(0,a.jsx)("div",{className:"bg-green-500 h-2.5 rounded-full",style:{width:"".concat(r.toFixed(2),"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-sm font-medium text-gray-600",children:[(0,a.jsxs)("span",{children:[(0,o.c)(t.amountCollected)," ETH raised"]}),(0,a.jsxs)("span",{children:[(0,o.c)(t.fundGoal)," ETH goal"]})]})]}),(0,a.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,a.jsxs)("p",{children:["Deadline: ",new Date(1e3*i).toLocaleDateString()]}),(0,a.jsxs)("p",{className:"text-sm",children:["Status: ",t.completed?"Completed":"Active"]}),(0,a.jsxs)("p",{className:"text-sm",children:["Owner: ",t.owner.slice(0,6),"...",t.owner.slice(-4)]})]}),e&&e.toLowerCase()===t.owner.toLowerCase()&&!t.completed&&(0,a.jsxs)("div",{className:"flex space-x-2 mt-4",children:[s>0&&(0,a.jsx)("button",{onClick:()=>$(t.id),disabled:z,className:"bg-purple-500 text-white px-3 py-1 rounded text-sm hover:bg-purple-600 disabled:bg-gray-400",children:z?"Withdrawing...":"Withdraw"}),(0,a.jsx)("button",{onClick:()=>k(t.id),disabled:C,className:"bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 disabled:bg-gray-400",children:C?"Completing...":"Mark Complete"})]}),(0,a.jsxs)("div",{className:"p-6 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Refund"}),t.owner.toLowerCase()!==(null==e?void 0:e.toLowerCase())&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("button",{onClick:()=>Z(t.id),disabled:W,className:"w-50px py-2 px-4 rounded-md text-white ".concat(W?"bg-gray-400 cursor-not-allowed":"bg-red-500 hover:bg-red-600"),children:W?"Processing Refund...":"Request Refund"}),J&&(0,a.jsxs)("p",{className:"text-red-500 text-sm mt-2",children:["Error: ",J.message]}),X&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-green-50 text-green-700 rounded-lg text-sm",children:["Refund initiated!"," ",(0,a.jsx)("a",{href:"https://sepolia.scrollscan.com//tx/".concat(X),target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-green-800",children:"View transaction"})]})]}),t.owner.toLowerCase()===(null==e?void 0:e.toLowerCase())&&(0,a.jsx)("p",{className:"text-gray-500",children:"As the creator of this idea, you cannot request refunds."})]})]},t.id)})}):(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No ideas found. Create one to get started!"})]})]}):(0,a.jsx)("w3m-button",{})]})}},5541:(e,t,n)=>{Promise.resolve().then(n.bind(n,2377))}},e=>{var t=t=>e(e.s=t);e.O(0,[192,441,684,358],()=>t(5541)),_N_E=e.O()}]);